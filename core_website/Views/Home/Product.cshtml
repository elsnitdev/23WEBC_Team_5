@{
    ViewData["ActivePage"] = "Product";
}
@model List<core_website.Areas.Api.Models.SanPham>
<div class="product-model">
    <div class="container">
        @await Html.PartialAsync("_Breadcrumb")
        <h2>Our Products</h2>
        <div class="col-md-9 product-model-sec" id="product-list">
        </div>
        @await Html.PartialAsync("_Sidebar")
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            function loadProducts() {
                // Call API to fetch data
                $.ajax({
                    url: '/api/products',
                    type: 'GET',
                    dataType: 'json',
                    success: function (data) {
                        // Call ViewComponent route
                        $.ajax({
                            url: '/Home/GetProductList',
                            type: 'POST',
                            contentType: 'application/json',
                            accepts: 'text/html',
                            data: JSON.stringify(data),
                            success: function (html) {
                                // Update the DOM with the rendered HTML
                                $('#product-list').html(html);
                            },
                            error: function (xhr, status, error) {
                                console.error('Error rendering view component:', error);
                                $('#product-list').html('<p>Error loading products.</p>');
                            }
                        });
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching products:', error);
                        $('#product-list').html('<p>Error loading products.</p>');
                    }
                });
            }

            // Execute the function
            loadProducts();
        });
    </script>
}